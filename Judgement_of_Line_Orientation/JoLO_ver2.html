<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>JLO Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        #intro {
            margin: 20px;
        }
        #imageContainer1, #imageContainer2 {
            margin: 20px;
            display: none; /* Initially hidden */
        }
        button {
            margin: 5px;
            padding: 10px 20px;
        }
    </style>
</head>
<body>
    <div id="intro">
        <h1>线条定向判断测试</h1>
        <p>请点击下方按钮选择每个线条对应的正确编号。每张图您只可以选择两次。</p>
        <button id="startButton" onclick="startTest()">开始测试</button>
    </div>

    <div id="imageContainer1" class="imageContainer hidden">
        <img src="test.png" alt="JLO Test Image 1">
        <div id="buttons1">
            <button onclick="recordChoice(1, 'test1')">1</button>
            <!-- More buttons for test1 -->
        </div>
    </div>

    <div id="imageContainer2" class="imageContainer hidden">
        <img src="test2.png" alt="JLO Test Image 2">
        <div id="buttons2">
            <button onclick="recordChoice(1, 'test2')">1</button>
            <!-- More buttons for test2 -->
        </div>
    </div>

    <script>
        let scores = { test1: 0, test2: 0 };
        let attempts = { test1: 0, test2: 0 };
        let correctAnswers = { test1: [3, 6], test2: [2, 5] }; // example correct answers

        function startTest() {
            document.getElementById('startButton').style.display = 'none'; // Hide start button only
            document.getElementById('imageContainer1').style.display = 'block'; // Show the first test
        }

        function recordChoice(choice, test) {
            attempts[test]++;
            if (correctAnswers[test].includes(choice)) {
                alert('正确！您选择的编号是: ' + choice);
                scores[test] += 1;
            } else {
                alert('错误！您选择的编号是: ' + choice);
            }

            if (attempts[test] >= 2) {
                if (test === 'test1') {
                    alert('您已完成第一张图的游戏！');
                    document.getElementById('imageContainer1').classList.add('hidden');
                    document.getElementById('imageContainer2').classList.remove('hidden');
                } else {
                    alert('您已完成第二张图的游戏！');
                    generateCSV();
                }
            }
        }

        function generateCSV() {
            let csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "Score Test 1,Score Test 2\r\n";
            csvContent += scores.test1 + "," + scores.test2 + "\r\n";
            var encodedUri = encodeURI(csvContent);
            var link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "jlo_test_results.csv");
            document.body.appendChild(link);
            link.click();
        }
    </script>
</body>
</html>
